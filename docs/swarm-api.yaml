swagger: '2.0'
info:
  version: 1.0.0
  title: Simple API
  description: A simple API to learn how to write OpenAPI Specification
schemes:
  - http
  - https
host: '192.168.3.121:4000'
basePath: /v1.0
consumes:
  - application/json
produces:
  - application/json
paths:
  /configs/system:
    get:
      summary: 查询系统配置（mgm）信息
      description: 查询配置
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/systemConfig'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  /nfs_backups/space:
    get:
      summary: Gets nfs space info
      description: Returns nfs total size and free size
      parameters:
        - name: nfs_ip
          in: query
          description: nfs远程服务IP
          required: true
          type: string
        - name: nfs_dir
          in: query
          description: nfs远程目录
          required: true
          type: string
        - name: nfs_mount_dir
          in: query
          description: 本地挂载目录
          required: true
          type: string
        - name: nfs_mount_opts
          in: query
          description: nfs挂载选项
          required: true
          type: string
      responses:
        '200':
          description: nfs total size and free size
          schema:
            properties:
              total_space:
                type: integer
              free_space:
                type: integer
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  /tasks:
    get:
      description: 任务批量查询
      parameters:
        - name: all
          in: query
          type: boolean
        - name: status
          in: query
          type: integer
        - name: link
          in: query
          type: string
      responses:
        '200':
          description: silce of Task
          schema:
            type: array
            items:
              $ref: '#/definitions/Task'
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部数据库查询错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/tasks/{name}':
    get:
      description: 查询指定任务
      parameters:
        - name: name
          in: path
          required: true
          description: The task's id or name
          type: string
      responses:
        '200':
          description: 指定任务信息
          schema:
            $ref: '#/definitions/Task'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  /tasks/backup/callback:
    post:
      description: '备份文件任务完成,备份文件信息回调'
      parameters:
        - name: backup
          in: body
          description: the backup task callback.
          schema:
            $ref: '#/definitions/BackupTaskCallBack'
      responses:
        '201':
          description: 逻辑执行成功
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部数据库查询错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  /softwares/images:
    get:
      description: 查询所有images
      responses:
        '200':
          description: silce of images
          schema:
            type: array
            items:
              $ref: '#/definitions/ImageResponse'
        '500':
          description: 内部数据库查询错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
    post:
      description: image 入库
      parameters:
        - name: image
          in: body
          description: load image request
          required: true
          schema:
            $ref: '#/definitions/PostLoadImageRequest'
      responses:
        '201':
          description: 创建load image 任务
          schema:
            $ref: '#/definitions/CreateTaskResponse'
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部数据库查询错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  /softwares/images/supported:
    get:
      description: '查询所有支持的images版本,异步接口'
      responses:
        '200':
          description: silce of image version
          schema:
            type: array
            items:
              $ref: '#/definitions/ImageVersion'
        '500':
          description: 内部数据库查询错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/softwares/images/{id}':
    get:
      description: get image & template config
      parameters:
        - name: id
          in: path
          required: true
          type: string
          description: image name or id
      responses:
        '200':
          description: returns image with template config
          schema:
            properties:
              id:
                type: string
              docker_image_id:
                type: string
              name:
                type: string
              major_version:
                type: integer
              minor_version:
                type: integer
              patch_version:
                type: integer
              build_version:
                type: integer
              size:
                type: integer
              label:
                type: string
              upload_at:
                type: string
                format: date-time
              config_template:
                $ref: '#/definitions/configTemplate'
    put:
      description: 修改image的配置文件模板
      parameters:
        - name: id
          in: path
          required: true
          type: string
          description: image name or id
        - name: template
          in: body
          required: true
          description: image template config
          schema:
            $ref: '#/definitions/configTemplate'
      responses:
        '200':
          description: OK
    delete:
      description: delete image by id
      parameters:
        - name: id
          in: path
          required: true
          description: image id
          type: string
      responses:
        '204':
          description: 指定image删除成功
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  /clusters:
    get:
      description: 查询所有的主机集群
      responses:
        '200':
          description: 集群信息
          schema:
            type: array
            items:
              $ref: '#/definitions/GetClusterResponse'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
    post:
      description: 新增集群
      parameters:
        - name: request
          in: body
          required: true
          schema:
            $ref: '#/definitions/PostClusterRequest'
      responses:
        '201':
          description: 成功
          schema:
            $ref: '#/definitions/IDResonse'
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/clusters/{id}':
    get:
      description: get cluster by id
      parameters:
        - name: id
          in: path
          required: true
          description: cluster id
          type: string
      responses:
        '200':
          description: 指定群集信息
          schema:
            $ref: '#/definitions/GetClusterResponse'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
    put:
      description: 修改集群参数
      parameters:
        - name: id
          in: path
          required: true
          description: cluster id
          type: string
        - name: request
          in: body
          required: true
          schema:
            $ref: '#/definitions/PostClusterRequest'
      responses:
        '200':
          description: 修改成功
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
    delete:
      description: 删除指定集群
      parameters:
        - name: id
          in: path
          required: true
          description: cluster id
          type: string
      responses:
        '204':
          description: 删除成功
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  /hosts:
    get:
      description: 查询所有主机或者按cluster id查询主机
      parameters:
        - name: cluster
          in: query
          description: cluster id
          type: string
      responses:
        '200':
          description: slice of hosts
          schema:
            type: array
            items:
              $ref: '#/definitions/NodeInfo'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
    post:
      description: 主机入库
      parameters:
        - name: node
          in: body
          required: true
          schema:
            $ref: '#/definitions/PostNodeRequest'
      responses:
        '201':
          description: 主机入库任务创建成功，异步接口
          schema:
            properties:
              id:
                type: string
              addr:
                type: string
              task_id:
                type: string
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/hosts/{id}':
    get:
      description: 查询指定主机信息
      parameters:
        - name: id
          in: path
          required: true
          description: host id or engine ID
          type: string
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/NodeInfo'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
    put:
      description: 修改主机参数
      parameters:
        - name: id
          in: path
          required: true
          description: host id or engine ID
          type: string
        - name: max_container
          in: body
          required: true
          description: 最大可运行容器数量
          schema:
            properties:
              max_container:
                type: integer
      responses:
        '200':
          description: OK
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
    delete:
      description: 主机出库
      parameters:
        - name: id
          in: path
          required: true
          description: host id or engine ID
          type: string
        - name: force
          in: query
          required: false
          description: 是否强制出库，忽略检查执行出库
          type: boolean
        - name: timeout
          in: query
          required: false
          description: 超时时间，单位 /s
          type: integer
        - name: username
          in: query
          required: true
          description: host ssh login username
          type: string
        - name: password
          in: query
          required: true
          description: host ssh login password
          type: string
      responses:
        '204':
          description: OK
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/hosts/{id}/enable':
    put:
      description: 修改主机状态，启用
      parameters:
        - name: id
          in: path
          required: true
          description: host id or engine ID
          type: string
      responses:
        '200':
          description: OK
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/hosts/{id}/disable':
    put:
      description: 修改主机状态，停用
      parameters:
        - name: id
          in: path
          required: true
          description: host id or engine ID
          type: string
      responses:
        '200':
          description: OK
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  /networkings:
    get:
      description: 查询所有 IP 网段
      responses:
        '200':
          description: OK
          schema:
            type: array
            items:
              $ref: '#/definitions/NetworkingInfo'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/networkings/{id}':
    get:
      description: 查询指定网段 IP
      parameters:
        - name: id
          in: path
          required: true
          description: networking id
          type: string
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/NetworkingInfo'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/networkings/{id}/ips':
    post:
      description: 增加指定网段 IP
      parameters:
        - name: id
          in: path
          required: true
          description: networking id
          type: string
        - name: networking
          in: body
          description: The networking to create.
          schema:
            $ref: '#/definitions/PostNetworkingRequest'
      responses:
        '201':
          description: 返回增加的IP数量
          schema:
            properties:
              num:
                type: integer
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
    delete:
      description: 删除指定网段 id 的IP
      parameters:
        - name: id
          in: path
          required: true
          description: networking id
          type: string
      responses:
        '204':
          description: OK
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/netwokings/{id}/ips/enable':
    put:
      description: 修改网段状态，启用
      parameters:
        - name: id
          in: path
          required: true
          description: networking id
          type: string
        - name: all
          in: query
          required: false
          description: 所属网段id 下全部IP，可选
          type: string
        - name: body
          in: body
          required: false
          description: 所属网段id 下全部IP，可选
          schema:
            type: array
            items:
              type: string
      responses:
        '200':
          description: OK
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/netwokings/{id}/ips/disable':
    put:
      description: 修改网段状态，停用
      parameters:
        - name: id
          in: path
          required: true
          description: networking id
          type: string
        - name: all
          in: query
          required: false
          description: 所属网段id 下全部IP，可选
          type: string
        - name: body
          in: body
          required: false
          description: 所属网段id 下全部IP，可选
          schema:
            type: array
            items:
              type: string
      responses:
        '200':
          description: OK
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  /services:
    get:
      summary: 查询全部 services
      description: 查询全部 services
      responses:
        '200':
          description: OK
          schema:
            type: array
            items:
              $ref: '#/definitions/ServiceSpec'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
    post:
      summary: 创建并运行新Service
      description: 创建Service任务，调度、分配资源、创建容器并初始化运行服务
      parameters:
        - name: timeout
          in: query
          required: false
          description: 超时时间 /s，可选
          type: integer
        - name: body
          in: body
          required: true
          description: 所属网段id 下全部IP，可选
          schema:
            $ref: '#/definitions/PostServiceRequst'
      responses:
        '201':
          description: 返回任务信息
          schema:
            type: object
            properties:
              id:
                type: string
              name:
                type: string
                description: 服务Name
              task_id:
                type: string
              units_id:
                type: array
                items:
                  type: string
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/services/{id}':
    get:
      summary: 查询指定Service
      description: 返回Service及所属容器及其运行状态，by id or name
      parameters:
        - name: id
          in: path
          required: true
          description: service id or name
          type: string
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/ServiceSpec'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
    delete:
      summary: 删除指定Service
      description: 删除Service相关记录，回收容器、存储、网络资源
      parameters:
        - name: id
          in: path
          required: true
          description: service id or name
          type: string
        - name: force
          in: query
          required: false
          description: force to delete service
          type: boolean
      responses:
        '204':
          description: Done
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/services/{id}/start':
    post:
      summary: 启动指定服务
      description: 启动服务，by id or name
      parameters:
        - name: id
          in: path
          required: true
          description: service id or name
          type: string
      responses:
        '201':
          description: OK
          schema:
            $ref: '#/definitions/TaskIDResonse'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/services/{id}/stop':
    post:
      summary: 关闭指定服务
      description: 关闭服务，by id or name
      parameters:
        - name: id
          in: path
          required: true
          description: service id or name
          type: string
      responses:
        '201':
          description: OK
          schema:
            $ref: '#/definitions/TaskIDResonse'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/services/{id}/scale':
    post:
      summary: 服务水平扩展
      description: 服务节点对等扩展，扩展指定相同资源配置的节点数
      parameters:
        - name: id
          in: path
          required: true
          description: service id or name
          type: string
        - name: body
          in: body
          required: true
          description: scale request parameters
          schema:
            $ref: '#/definitions/serviceScaleRequest'
      responses:
        '201':
          description: OK，返回 task_id.
          schema:
            $ref: '#/definitions/TaskIDResonse'
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/services/{id}/update':
    post:
      summary: 服务可使用资源扩缩
      description: 服务容器资源扩缩，扩缩到指定大小的资源配置，其他配置保持不变
      parameters:
        - name: id
          in: path
          required: true
          description: service id or name
          type: string
        - name: body
          in: body
          required: true
          description: unit required resources config
          schema:
            $ref: '#/definitions/unitRequire'
      responses:
        '201':
          description: OK，返回 task_id.
          schema:
            $ref: '#/definitions/TaskIDResonse'
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/services/{id}/image/update':
    post:
      summary: 服务容器镜像版本升级
      description: 升级所属服务的容器中的镜像版本，其他配置保持不变
      parameters:
        - name: id
          in: path
          required: true
          description: service id or name
          type: string
        - name: image
          in: query
          required: true
          description: image version name or image id or docker image id
          type: string
      responses:
        '201':
          description: OK，返回 task_id.
          schema:
            $ref: '#/definitions/TaskIDResonse'
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/services/{id}/config/update':
    post:
      summary: 服务配置文件升级
      description: 更新服务容器中的配置文件
      parameters:
        - name: id
          in: path
          required: true
          description: service id or name
          type: string
        - name: updateConfig
          in: body
          required: true
          description: 配置文件的配置
          schema:
            properties:
              Configs:
                type: object
                additionalProperties:
                  $ref: '#/definitions/configCmds'
              Args:
                type: object
                additionalProperties:
                  type: string
      responses:
        '201':
          description: OK，返回 task_id.
          schema:
            $ref: '#/definitions/TaskIDResonse'
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/services/{id}/exec':
    post:
      summary: 在服务容器内执行命令
      description: 在所属服务指定容器内执行特定指令
      parameters:
        - name: id
          in: path
          required: true
          description: service id or name
          type: string
        - name: ececConfig
          in: body
          required: true
          description: 待执行指令及执行方式
          schema:
            properties:
              detach:
                type: boolean
              nameOrID:
                type: string
                description: '指定容器id或者unit id or name,为空时所属服务的容器全部执行特定指令'
              cmd:
                type: array
                items:
                  type: string
      responses:
        '201':
          description: OK，返回 task_id.
          schema:
            $ref: '#/definitions/TaskIDResonse'
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/services/{id}/backup':
    post:
      summary: 在服务容器内执行备份任务
      description: 在所属服务指定容器内执行备份任务
      parameters:
        - name: id
          in: path
          required: true
          description: service id or name
          type: string
        - name: backupCofig
          in: body
          required: true
          schema:
            properties:
              detach:
                type: boolean
              nameOrID:
                type: string
                description: '指定容器id或者unit id or name,为空时所属服务的容器全部执行特定指令'
              type:
                type: string
                description: 备份类型（增量备份、全备份）
              backup_dir:
                type: string
                description: 备份文件存储目录
      responses:
        '201':
          description: OK，返回 task_id.
          schema:
            $ref: '#/definitions/TaskIDResonse'
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/services/{id}/restore':
    post:
      summary: 从指定文件中恢复服务中某容器的数据
      description: 在所属服务指定容器内执行特定指令
      parameters:
        - name: id
          in: path
          required: true
          description: service id or name
          type: string
        - name: body
          in: body
          required: true
          schema:
            properties:
              units:
                type: array
                items:
                  type: string
                  description: '指定容器id或者unit id or name,为空时所属服务的容器全部执行特定指令'
              file:
                type: string
                description: 指定的备份文件
      responses:
        '201':
          description: OK，返回 task_id.
          schema:
            $ref: '#/definitions/TaskIDResonse'
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/services/{id}/rebuild':
    post:
      summary: 重建所属服务下的指定unit
      description: 重建所属服务下的指定unit，重建后的网络ip：port配置不变
      parameters:
        - name: id
          in: path
          required: true
          description: service id or name
          type: string
        - name: body
          in: body
          required: true
          schema:
            properties:
              units:
                type: array
                items:
                  type: string
                  description: '指定容器id或者unit id or name,为空时所属服务的容器全部执行特定指令'
              candidates:
                type: array
                items:
                  type: string
              users:
                type: array
                items:
                  $ref: '#/definitions/User'
      responses:
        '201':
          description: OK，返回 task_id.
          schema:
            $ref: '#/definitions/TaskIDResonse'
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
  '/services/{id}/migrate':
    post:
      summary: 迁移所属服务下的指定unit
      description: 迁移所属服务下的指定unit，重建后的网络ip：port配置不变，volume不变，只有外部存储可实现数据迁移，以SAN存储为例
      parameters:
        - name: id
          in: path
          required: true
          description: service id or name
          type: string
        - name: body
          in: body
          required: true
          schema:
            properties:
              nameOrID:
                type: string
                description: '指定容器id或者unit id or name,为空时所属服务的容器全部执行特定指令'
              candidates:
                type: array
                items:
                  type: string
      responses:
        '201':
          description: OK，返回 task_id.
          schema:
            $ref: '#/definitions/TaskIDResonse'
        '400':
          description: 参数错误或参数校验问题
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
        '500':
          description: 内部逻辑错误
          schema:
            $ref: '#/definitions/ErrorResponseHeader'
definitions:
  TaskIDResonse:
    properties:
      task_id:
        type: string
  IDResonse:
    properties:
      id:
        type: string
  ErrorResponseHeader:
    properties:
      result:
        type: boolean
      code:
        type: integer
      msg:
        type: string
      category:
        type: string
  CreateTaskResponse:
    properties:
      id:
        type: string
      task_id:
        type: string
  Task:
    properties:
      id:
        type: string
      name:
        type: string
      related:
        type: string
      linkto:
        type: string
      description:
        type: string
      labels:
        type: string
      errors:
        type: string
      status:
        type: integer
      timestamp:
        type: integer
      timeout:
        type: integer
      created_at:
        type: string
        format: date-time
      finished_at:
        type: string
        format: date-time
  BackupTaskCallBack:
    properties:
      task_id:
        type: string
      unit_id:
        type: string
      type:
        type: string
      path:
        type: string
      code:
        type: integer
      size:
        type: integer
      msg:
        type: string
  ImageVersion:
    properties:
      name:
        type: string
      major_version:
        type: integer
      minor_version:
        type: integer
      patch_version:
        type: integer
      build_version:
        type: integer
  ImageResponse:
    properties:
      id:
        type: string
      docker_image_id:
        type: string
      name:
        type: string
      major_version:
        type: integer
      minor_version:
        type: integer
      patch_version:
        type: integer
      build_version:
        type: integer
      size:
        type: integer
      label:
        type: string
      upload_at:
        type: string
        format: date-time
  configTemplate:
    properties:
      image:
        type: string
      log_mount:
        type: string
      data_mount:
        type: string
      config_file:
        type: string
      content:
        type: string
      timestamp:
        type: integer
      keysets:
        type: array
        items:
          type: object
          properties:
            can_set:
              type: boolean
            must_restart:
              type: boolean
            key:
              type: string
            default:
              type: string
            desc:
              type: string
            range:
              type: string
  PostLoadImageRequest:
    properties:
      name:
        type: string
      major_version:
        type: integer
      minor_version:
        type: integer
      patch_version:
        type: integer
      build_version:
        type: integer
      path:
        type: string
      timeout:
        type: integer
  GetClusterResponse:
    properties:
      id:
        type: string
      max_host:
        type: integer
      host_num:
        type: integer
      usage_limit:
        type: number
  PostClusterRequest:
    properties:
      max_host:
        type: integer
      usage_limit:
        type: number
  VolumeDriver:
    properties:
      name:
        type: string
      driver:
        type: string
      type:
        type: string
      VG:
        type: string
      total:
        type: integer
      free:
        type: integer
  engine:
    properties:
      id:
        type: string
      name:
        type: string
      ip:
        type: string
      server_version:
        type: string
      kernel_version:
        type: string
      os:
        type: string
      os_type:
        type: string
      architecture:
        type: string
      is_healthy:
        type: boolean
      cpus:
        type: integer
      memory:
        type: integer
      free_cpus:
        type: integer
      free_memory:
        type: integer
  container:
    properties:
      id:
        type: string
      name:
        type: string
      image:
        type: string
      command:
        type: string
      created:
        type: string
      status:
        type: string
  NodeInfo:
    properties:
      id:
        type: string
      cluster:
        type: string
      room:
        type: string
      seat:
        type: string
      max_container:
        type: integer
      enabled:
        type: boolean
      register_at:
        type: string
        format: date-time
      Engine:
        $ref: '#/definitions/engine'
      Containers:
        type: array
        items:
          $ref: '#/definitions/container'
      volume_drivers:
        type: array
        items:
          $ref: '#/definitions/VolumeDriver'
  PostNodeRequest:
    properties:
      cluster_id:
        type: string
      addr:
        type: string
      storage:
        type: string
      max_contianer:
        type: integer
      room:
        type: string
      seat:
        type: string
      username:
        type: string
      password:
        type: string
      nsf_ip:
        type: string
      nfs_dir:
        type: string
      nfs_mount_dir:
        type: string
      nfs_mount_opts:
        type: string
      hdd:
        type: array
        items:
          type: string
      ssd:
        type: array
        items:
          type: string
  IP:
    properties:
      enabled:
        type: boolean
      ip_addr:
        type: string
      unit_id:
        type: string
      engine_id:
        type: string
      net_dev:
        type: string
      bandwidth:
        type: integer
  NetworkingInfo:
    properties:
      prefix:
        type: integer
      vlan_id:
        type: integer
      networking_id:
        type: string
      gateway:
        type: string
      IPs:
        type: array
        items:
          $ref: '#/definitions/IP'
  PostNetworkingRequest:
    properties:
      prefix:
        type: integer
      vlan_id:
        type: integer
      start:
        type: string
      end:
        type: string
      networking_id:
        type: string
      gateway:
        type: string
  Service:
    properties:
      id:
        type: string
      name:
        type: string
      desc:
        type: string
      architecture:
        type: string
      tag:
        type: string
      auto_healing:
        type: boolean
      auto_scaling:
        type: boolean
      high_available:
        type: boolean
      status:
        type: integer
      max_backup_space:
        type: integer
      backup_files_retention:
        type: integer
      created_at:
        type: string
        format: date-time
      finished_at:
        type: string
        format: date-time
  Arch:
    properties:
      unit_num:
        type: integer
      mode:
        type: string
      code:
        type: string
  Unit:
    properties:
      id:
        type: string
      name:
        type: string
      type:
        type: string
      service_id:
        type: string
      engine_id:
        type: string
      container_id:
        type: string
      network_mode:
        type: string
      lastest_error:
        type: integer
      created_at:
        type: string
        format: data-time
  unit_engine:
    properties:
      id:
        type: string
      node:
        type: string
      name:
        type: string
      addr:
        type: string
  MountPoint:
    properties:
      Name:
        type: string
      Source:
        type: string
      Destination:
        type: string
      Driver:
        type: string
      Mode:
        type: string
      RW:
        type: boolean
      Propagation:
        type: string
        enum:
          - rprivate
          - private
          - rshared
          - shared
          - rslave
          - slave
  TypesContainer:
    properties:
      Id:
        type: string
      Names:
        type: array
        items:
          type: string
      Image:
        type: string
      ImageID:
        type: string
      Command:
        type: string
      Created:
        type: integer
      Labels:
        type: object
        additionalProperties:
          type: string
      State:
        type: string
      Status:
        type: string
      HostConfig:
        type: object
        properties:
          NetworkMode:
            type: string
      Mounts:
        type: array
        items:
          $ref: '#/definitions/MountPoint'
  containerConfig:
    properties:
      Hostname:
        type: string
      Domainname:
        type: string
      User:
        type: string
      AttachStdin:
        type: boolean
      AttachStdout:
        type: boolean
      AttachStderr:
        type: boolean
      Tty:
        type: boolean
      OpenStdin:
        type: boolean
      StdinOnce:
        type: boolean
      Env:
        type: array
        items:
          type: string
      Cmd:
        type: array
        items:
          type: string
      Image:
        type: string
      WorkingDir:
        type: string
      Labels:
        type: object
        additionalProperties:
          type: string
      Entrypoint:
        type: array
        items:
          type: string
      OnBuild:
        type: array
        items:
          type: string
      Shell:
        type: array
        items:
          type: string
  HostConfigResources:
    properties:
      CpuShares:
        type: integer
      Memory:
        type: integer
      NanoCpus:
        type: integer
      BlkioWeight:
        type: integer
      CpuPeriod:
        type: integer
      CpuQuota:
        type: integer
      CpuRealtimePeriod:
        type: integer
      CpuRealtimeRuntime:
        type: integer
      DiskQuota:
        type: integer
      KernelMemory:
        type: integer
      MemoryReservation:
        type: integer
      MemorySwap:
        type: integer
      MemorySwappiness:
        type: integer
      PidsLimit:
        type: integer
      OomKillDisable:
        type: boolean
      CpuCount:
        type: integer
      CpuPercent:
        type: integer
      IOMaximumIOps:
        type: integer
      IOMaximumBandwidth:
        type: integer
      CgroupParent:
        type: string
      CpusetCpus:
        type: string
      CpusetMems:
        type: string
  HostConfig:
    properties:
      Binds:
        type: array
        items:
          type: string
      ContainerIDFile:
        type: string
      NetworkMode:
        type: string
      AutoRemove:
        type: boolean
      VolumeDriver:
        type: string
      VolumeFrom:
        type: array
        items:
          type: string
      IpcMode:
        type: string
      Cgroup:
        type: string
      PidMode:
        type: string
      Runtime:
        type: string
      UTSMode:
        type: string
      UsernsMode:
        type: string
      Isolation:
        type: string
      ShmSize:
        type: integer
      CpuShares:
        type: integer
      Memory:
        type: integer
      NanoCpus:
        type: integer
      BlkioWeight:
        type: integer
      CpuPeriod:
        type: integer
      CpuQuota:
        type: integer
      CpuRealtimePeriod:
        type: integer
      CpuRealtimeRuntime:
        type: integer
      DiskQuota:
        type: integer
      KernelMemory:
        type: integer
      MemoryReservation:
        type: integer
      MemorySwap:
        type: integer
      MemorySwappiness:
        type: integer
      PidsLimit:
        type: integer
      OomKillDisable:
        type: boolean
      CpuCount:
        type: integer
      CpuPercent:
        type: integer
      IOMaximumIOps:
        type: integer
      IOMaximumBandwidth:
        type: integer
      CgroupParent:
        type: string
      CpusetCpus:
        type: string
      CpusetMems:
        type: string
  ContainerConfig:
    properties:
      HostConfig:
        $ref: '#/definitions/HostConfig'
      Hostname:
        type: string
      Domainname:
        type: string
      User:
        type: string
      AttachStdin:
        type: boolean
      AttachStdout:
        type: boolean
      AttachStderr:
        type: boolean
      Tty:
        type: boolean
      OpenStdin:
        type: boolean
      StdinOnce:
        type: boolean
      Env:
        type: array
        items:
          type: string
      Cmd:
        type: array
        items:
          type: string
      Image:
        type: string
      WorkingDir:
        type: string
      Labels:
        type: object
        additionalProperties:
          type: string
      Entrypoint:
        type: array
        items:
          type: string
      OnBuild:
        type: array
        items:
          type: string
      Shell:
        type: array
        items:
          type: string
  unitIP:
    properties:
      prefix:
        type: integer
      vlan:
        type: integer
      bandwidth:
        type: integer
      device:
        type: string
      name:
        type: string
      ip_addr:
        type: string
      proto:
        type: string
      gateway:
        type: string
      networking:
        type: string
  unitPort:
    properties:
      name:
        type: string
      port:
        type: integer
  volumeSpec:
    properties:
      id:
        type: string
      name:
        type: string
      type:
        type: string
      driver:
        type: string
      size:
        type: integer
      options:
        type: object
        additionalProperties:
          type: string
  UnitSpec:
    properties:
      unit:
        $ref: '#/definitions/Unit'
      engine:
        $ref: '#/definitions/unit_engine'
      container:
        $ref: '#/definitions/TypesContainer'
      container_config:
        $ref: '#/definitions/ContainerConfig'
      networkings:
        type: array
        items:
          $ref: '#/definitions/unitIP'
      ports:
        type: array
        items:
          $ref: '#/definitions/unitPort'
      volumes:
        type: array
        items:
          $ref: '#/definitions/volumeSpec'
  ServiceSpec:
    properties:
      id:
        type: string
      name:
        type: string
      desc:
        type: string
      tag:
        type: string
      auto_healing:
        type: boolean
      auto_scaling:
        type: boolean
      high_available:
        type: boolean
      status:
        type: integer
      max_backup_space:
        type: integer
      backup_files_retention:
        type: integer
      created_at:
        type: string
        format: date-time
      finished_at:
        type: string
        format: date-time
      architecture:
        $ref: '#/definitions/Arch'
      units:
        type: array
        items:
          $ref: '#/definitions/UnitSpec'
      opts:
        type: object
        additionalProperties:
          type: string
  User:
    properties:
      name:
        type: string
      password:
        type: string
      role:
        type: string
      privilege:
        type: string
  PostServiceRequst:
    properties:
      id:
        type: string
      name:
        type: string
      desc:
        type: string
      tag:
        type: string
      auto_healing:
        type: boolean
      auto_scaling:
        type: boolean
      high_available:
        type: boolean
      status:
        type: integer
      max_backup_space:
        type: integer
      backup_files_retention:
        type: integer
      created_at:
        type: string
        format: date-time
      finished_at:
        type: string
        format: date-time
      architecture:
        $ref: '#/definitions/Arch'
      unit_require:
        $ref: '#/definitions/unitRequire'
      cluster_id:
        type: array
        items:
          type: string
      constraints:
        type: array
        items:
          type: string
      opts:
        type: object
        additionalProperties:
          type: string
      users:
        type: array
        items:
          $ref: '#/definitions/User'
      networking:
        type: object
        additionalProperties:
          type: array
          items:
            type: string
  unitRequire:
    properties:
      require:
        type: object
        properties:
          ncpu:
            type: integer
          memory:
            type: integer
      limit:
        type: object
        properties:
          ncpu:
            type: integer
          memory:
            type: integer
      volumes:
        type: array
        items:
          properties:
            from:
              type: string
            name:
              type: string
            type:
              type: string
            driver:
              type: string
            size:
              type: integer
            options:
              type: object
              additionalProperties:
                type: string
      networks:
        type: array
        items:
          properties:
            device:
              type: integer
            bandwidth:
              type: integer
  systemConfig:
    properties:
      dc_id:
        type: string
      backup_dir:
        type: string
      retry:
        type: integer
      docker_port:
        type: integer
      plugin_port:
        type: integer
      swarm_agent_port:
        type: integer
      consul_port:
        type: integer
      consul_wait_time:
        type: integer
      consul_ip:
        type: string
      consul_dc:
        type: string
      registry_port:
        type: integer
      registry_domain:
        type: string
      registry_ip:
        type: string
      source_dir:
        type: string
      destination_dir:
        type: string
      init_script_name:
        type: string
      clean_script_name:
        type: string
  serviceScaleRequest:
    properties:
      architecture:
        $ref: '#/definitions/Arch'
      candidates:
        type: array
        items:
          type: string
      users:
        type: array
        items:
          $ref: '#/definitions/User'
      options:
        type: object
        additionalProperties:
          type: string
  configCmds:
    properties:
      ID:
        type: string
      Name:
        type: string
      Version:
        type: string
      Content:
        type: string
      LogMount:
        type: string
      DataMount:
        type: string
      config_file:
        type: string
      Timestamp:
        type: integer
      Cmds:
        type: object
        additionalProperties:
          type: array
          items:
            type: string
